;-----------------------------------------------------------------------------------------
;首絞め派生
;-------------------------------------------------
@COM_正常位首絞め
PRINTL 正常位首絞め
SELECTCOMS = 正常位首絞め
SELECTCOM = GETNUM(TRAINNAME, "正常位首絞め")
CALL KOJO_MESSAGE_COM

CALL STRANGLE_PLAYERS, 1000
CALL STRANGLE_TARGETS, 200

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 90
LOSEBASE:気力 += 550

DOWNBASE:MASTER:体力 += 80
DOWNBASE:MASTER:気力 += 90

SOURCE:快V = 400
SOURCE:達成 = 30
SOURCE:苦痛 = 1200
SOURCE:恐怖 = 2200
SOURCE:中毒 = 200
SOURCE:欲情 = 400
SOURCE:露出 = 100
SOURCE:屈従 = 800
SOURCE:逸脱 = 550
SOURCE:反感 = 900

CALL STRANGLE_SOURCE

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL SOURCE_CHECK_CVAB

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
CALL SAMEN_CHECK, 1
CALL SAMEN_CHECK_T, 4

CALL SAMEN_SHOOT, 1, NOWEX:PLAYER:射精
CALL SAMEN_SHOOT_T, 4, NOWEX:射精

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;V経験
PRINTL Ｖ経験+1
EXP:Ｖ経験++

;性交経験
PRINTL 性交経験+1
EXP:性交経験++

CALL EXPUP, 2, 4

;依存度補正値(服従で1、隷属で2）
IF TALENT:服従 && PLAYER == MASTER
	TFLAG:依存度補正 += 1
ELSEIF TALENT:隷属 && PLAYER == MASTER
	TFLAG:依存度補正 += 2
ENDIF

RETURN 1

;-----------------------------------------------------------------------------------------
@COM_後背位首絞め
PRINTL 後背位首絞め
SELECTCOMS = 後背位首絞め
SELECTCOM = GETNUM(TRAINNAME, "後背位首絞め")
CALL KOJO_MESSAGE_COM

CALL STRANGLE_PLAYERS, 1200
CALL STRANGLE_TARGETS, 250

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 120
LOSEBASE:気力 += 570

DOWNBASE:MASTER:体力 += 80
DOWNBASE:MASTER:気力 += 90

SOURCE:快V = 450
SOURCE:達成 = 40
SOURCE:苦痛 = 1250
SOURCE:恐怖 = 2300
SOURCE:中毒 = 200
SOURCE:欲情 = 350
SOURCE:露出 = 120
SOURCE:屈従 = 1000
SOURCE:逸脱 = 550
SOURCE:反感 = 1000

CALL STRANGLE_SOURCE

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL SOURCE_CHECK_CVAB

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
CALL SAMEN_CHECK, 1
CALL SAMEN_CHECK_T, 4

CALL SAMEN_SHOOT, 1, NOWEX:PLAYER:射精
CALL SAMEN_SHOOT_T, 4, NOWEX:射精

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;V経験
EXP:Ｖ経験 += 1
PRINTL Ｖ経験+1

;性交経験
EXP:性交経験 += 1
PRINTL 性交経験+1

CALL EXPUP, 2, 4

;依存度補正値(服従で1、隷属で2）
IF TALENT:服従 && PLAYER == MASTER
	TFLAG:依存度補正 += 1
ELSEIF TALENT:隷属 && PLAYER == MASTER
	TFLAG:依存度補正 += 2
ENDIF

RETURN 1

;-----------------------------------------------------------------------------------------
@COM_正常位アナル首絞め
PRINTL 正常位アナル首絞め
SELECTCOMS = 正常位アナル首絞め
SELECTCOM = GETNUM(TRAINNAME, "正常位アナル首絞め")
CALL KOJO_MESSAGE_COM

CALL STRANGLE_PLAYERS, 1100
CALL STRANGLE_TARGETS, 450

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 200
LOSEBASE:気力 += 500

DOWNBASE:MASTER:体力 += 80
DOWNBASE:MASTER:気力 += 90

SOURCE:快A = 400
SOURCE:達成 = 50
SOURCE:苦痛 = 1400
SOURCE:恐怖 = 1500
SOURCE:中毒 = 200
SOURCE:欲情 = 400
SOURCE:露出 = 150
SOURCE:屈従 = 1500
SOURCE:逸脱 = 500
SOURCE:反感 = 1000

CALL STRANGLE_SOURCE

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL SOURCE_CHECK_CVAB

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
CALL SAMEN_CHECK, 2
CALL SAMEN_CHECK_T, 5

CALL SAMEN_SHOOT, 2, NOWEX:PLAYER:射精
CALL SAMEN_SHOOT_T, 5, NOWEX:射精

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
;A経験
EXP:Ａ経験 += 1
PRINTL Ａ経験+1

;性交経験
EXP:性交経験 += 1
PRINTL 性交経験+1

CALL EXPUP, 2, 4

;依存度補正値(服従で1、隷属で2）
IF TALENT:服従 && PLAYER == MASTER
	TFLAG:依存度補正 += 1
ELSEIF TALENT:隷属 && PLAYER == MASTER
	TFLAG:依存度補正 += 2
ENDIF

RETURN 1

;-----------------------------------------------------------------------------------------
@COM_後背位アナル首絞め
PRINTL 後背位アナル首絞め
SELECTCOMS = 後背位アナル首絞め
SELECTCOM = GETNUM(TRAINNAME, "後背位アナル首絞め")
CALL KOJO_MESSAGE_COM

CALL STRANGLE_PLAYERS, 1350
CALL STRANGLE_TARGETS, 500

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 200
LOSEBASE:気力 += 500

DOWNBASE:MASTER:体力 += 80
DOWNBASE:MASTER:気力 += 90

SOURCE:快A = 450
SOURCE:達成 = 60
SOURCE:苦痛 = 1500
SOURCE:恐怖 = 1500
SOURCE:中毒 = 200
SOURCE:欲情 = 500
SOURCE:露出 = 200
SOURCE:屈従 = 1500
SOURCE:逸脱 = 500
SOURCE:反感 = 1100

CALL STRANGLE_SOURCE

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL SOURCE_CHECK_CVAB

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
CALL SAMEN_CHECK, 2
CALL SAMEN_CHECK_T, 5

CALL SAMEN_SHOOT, 2, NOWEX:PLAYER:射精
CALL SAMEN_SHOOT_T, 5, NOWEX:射精

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
CALL EXPUP, 2, 4

;依存度補正値(服従で1、隷属で2）
IF TALENT:服従 && PLAYER == MASTER
	TFLAG:依存度補正 += 1
ELSEIF TALENT:隷属 && PLAYER == MASTER
	TFLAG:依存度補正 += 2
ENDIF

RETURN 1

;-----------------------------------------------------------------------------------------
@COM_逆レイプ首絞め
PRINTL 逆レイプ首絞め
SELECTCOMS = 逆レイプ首絞め
SELECTCOM = GETNUM(TRAINNAME, "逆レイプ首絞め")
CALL KOJO_MESSAGE_COM

CALL STRANGLE_PLAYERS, 700
CALL STRANGLE_TARGETS, 1000

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 150
LOSEBASE:気力 += 350

DOWNBASE:MASTER:体力 += 90
DOWNBASE:MASTER:気力 += 90

SOURCE:快C = 500
SOURCE:達成 = 150
SOURCE:苦痛 = 200
SOURCE:恐怖 = 1800
SOURCE:中毒 = 200
SOURCE:欲情 = 900
SOURCE:露出 = 300
SOURCE:屈従 = 2000
SOURCE:逸脱 = 500
SOURCE:反感 = 900

CALL STRANGLE_SOURCE

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL SOURCE_CHECK_CVAB

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
;射精時の処理
IF RESULT
	SELECTCASE SEX(PLAYER)
		CASE 1
			IF PLAYER == MASTER
				LOCAL = 6
			ELSEIF PLAYER == ASSI
				LOCAL = 7
			ENDIF
		CASE 2
			IF PLAYER == MASTER
				LOCAL = 1
			ELSEIF PLAYER == ASSI
				LOCAL = 2
			ENDIF
	ENDSELECT
ENDIF

CALL SAMEN_CHECK, 6
CALL SAMEN_CHECK_T, LOCAL

CALL SAMEN_SHOOT, 6, NOWEX:PLAYER:射精
CALL SAMEN_SHOOT_T, LOCAL, NOWEX:射精

;-------------------------------------------------
;経験の処理
;-------------------------------------------------
CALL EXPUP, 3, 5

;依存度補正値(服従で1、隷属で2）
IF TALENT:服従 && PLAYER == MASTER
	TFLAG:依存度補正 += 1
ELSEIF TALENT:隷属 && PLAYER == MASTER
	TFLAG:依存度補正 += 2
ENDIF

RETURN 1

;-------------------------------------------------
;射精ゲージチェック（主人）
;-------------------------------------------------
@STRANGLE_PLAYERS, ARG
LOCAL = ARG

;ABL:調教者の技巧をみる
LOCAL += (LOCAL/5)*ABL:PLAYER:技巧

;PALAM:潤滑をみる
LOCAL += (GETPALAMLV(PALAM:潤滑, 4)-2)*(LOCAL/5)

SELECTCASE SELECTCOMS
	CASE "正常位首絞め", "後背位首絞め", "正常位アナル首絞め", "後背位アナル首絞め"
		;プレイヤーのABL:Ｃ感覚をみる
		SELECTCASE ABL:Ｃ感覚
			CASE 0
				TIMES LOCAL , 1.00
			CASE 1
				TIMES LOCAL , 1.50
			CASE 2
				TIMES LOCAL , 2.00
			CASE 3
				TIMES LOCAL , 2.50
			CASE 4
				TIMES LOCAL , 3.50
			CASEELSE
				LOCAL += LOCAL*(ABL:PLAYER:Ｃ感覚-1)
		ENDSELECT
	CASE "逆アナル首絞め"
		SELECTCASE TFLAG:奴隷挿入箇所
			CASE 1
				;プレイヤーのABL:Ｖ感覚をみる
				SELECTCASE ABL:PLAYER:Ｖ感覚
					CASE 0
						TIMES LOCAL , 0.50
					CASE 1
						TIMES LOCAL , 0.80
					CASE 2
						TIMES LOCAL , 1.00
					CASE 3
						TIMES LOCAL , 1.50
					CASE 4
						TIMES LOCAL , 2.00
					CASEELSE
						LOCAL += (LOCAL/2)*ABL:PLAYER:Ｖ感覚
				ENDSELECT
			CASE 2
				;プレイヤーのABL:Ａ感覚をみる
				SELECTCASE ABL:PLAYER:Ａ感覚
					CASE 0
						TIMES LOCAL , 0.50
					CASE 1
						TIMES LOCAL , 0.80
					CASE 2
						TIMES LOCAL , 1.00
					CASE 3
						TIMES LOCAL , 1.50
					CASE 4
						TIMES LOCAL , 2.00
					CASEELSE
						LOCAL += (LOCAL/2)*ABL:PLAYER:Ａ感覚
				ENDSELECT
		ENDSELECT
ENDSELECT

;倒錯的、サド、狂気だと増える
SIF TALENT:PLAYER:倒錯的 || TALENT:PLAYER:サド || TALENT:PLAYER:狂気
	TIMES LOCAL , 1.50

CALL 射精ゲージ増加, LOCAL, PLAYER

;-------------------------------------------------
;射精ゲージチェック（奴隷）
;-------------------------------------------------
@STRANGLE_TARGETS, ARG
LOCAL = ARG

;ABL:調教者の技巧をみる
LOCAL += (LOCAL/5)*ABL:PLAYER:技巧

;ABL:欲望をみる
LOCAL += (LOCAL/10)*ABL:欲望

;PALAM:潤滑をみる
LOCAL += (GETPALAMLV(PALAM:潤滑, 4)-3)*(LOCAL/5)

;奴隷のABL:Ｖ感覚をみる
SELECTCASE SELECTCOMS
	CASE "正常位首絞め", "後背位首絞め"
		SELECTCASE ABL:Ｖ感覚
			CASE 0
				TIMES LOCAL , 0.50
			CASE 1
				TIMES LOCAL , 0.80
			CASE 2
				TIMES LOCAL , 1.00
			CASE 3
				TIMES LOCAL , 1.50
			CASE 4
				TIMES LOCAL , 2.00
			CASEELSE
				LOCAL += (LOCAL/2)*ABL:Ｖ感覚
		ENDSELECT
	CASE "正常位アナル首絞め", "後背位アナル首絞め"
		SELECTCASE ABL:Ａ感覚
			CASE 0
				TIMES LOCAL , 0.50
			CASE 1
				TIMES LOCAL , 0.80
			CASE 2
				TIMES LOCAL , 1.00
			CASE 3
				TIMES LOCAL , 1.50
			CASE 4
				TIMES LOCAL , 2.00
			CASEELSE
				LOCAL += (LOCAL/2)*ABL:Ａ感覚
		ENDSELECT
	CASE "逆アナル首絞め"
		SELECTCASE ABL:Ｃ感覚
			CASE 0
				TIMES LOCAL , 0.50
			CASE 1
				TIMES LOCAL , 0.80
			CASE 2
				TIMES LOCAL , 1.00
			CASE 3
				TIMES LOCAL , 1.50
			CASE 4
				TIMES LOCAL , 2.00
			CASEELSE
				LOCAL += (LOCAL/2)*ABL:Ｃ感覚
		ENDSELECT
ENDSELECT

;奴隷のABL:マゾっ気をみる
LOCAL += (LOCAL/3)*ABL:マゾっ気

CALL 射精ゲージ増加, LOCAL, TARGET

;-------------------------------------------------
;特殊ソース処理
;-------------------------------------------------
@STRANGLE_SOURCE
;素質などで情愛ソースが変化
SIF CFLAG:陥落
	SOURCE:情愛 += 300
SIF TALENT:倒錯的
	SOURCE:情愛 += 100
SIF TALENT:マゾ
	SOURCE:情愛 += 100
SIF TALENT:妄信
	SOURCE:情愛 += 100

SOURCE:情愛 += CFLAG:依存度/10

;苦痛のパラメータによる苦痛のソース増加は先に処理しておく
SOURCE:苦痛 += GETPALAMLV(PALAM:苦痛, 4)*(SOURCE:苦痛/2)

;抑圧、抵抗持ちには、抑鬱ソース追加
SIF TALENT:抑圧 || TALENT:抵抗
	SOURCE:鬱屈 += 300

;貞操観念持ちで恋慕、親愛持ち以外には常に反発のソースを追加する（セックス系のみ）
SELECTCASE SELECTCOMS
	CASE "正常位首絞め", "後背位首絞め"
		SIF TALENT:貞操観念 && FALLTYPE(TARGET) != 1 && PLAYER != MASTER
			SOURCE:反感 += 1000
ENDSELECT

;V、Aへの苦痛は先に処理しておく
;EXP:Ｖ経験、Ａ経験をみる（処女の反感は別途処理済みなので省略）
SELECTCASE SELECTCOMS
	CASE "正常位首絞め", "後背位首絞め"
		CALL 特殊ソース処理_Ｖ
	CASE "正常位アナル首絞め", "後背位アナル首絞め"
		CALL 特殊ソース処理_Ａ
ENDSELECT

CALL 特殊ソース処理_セックス

