;-------------------------------------------------
;シャワー
;-------------------------------------------------
@USERCOM_ABLE_シャワー, ARG
#FUNCTION
;解除はいつでも可能
IF TEQUIP:シャワー
	COMRESULT = 1
	RETURNF 1
ENDIF
;お風呂中じゃないとダメ
SIF !TEQUIP:お風呂場
	RETURNF 0
;クリキャップ使用中は不可
SIF TEQUIP:クリキャップ
	RETURNF 0
;ニプルキャップ使用中は不可
SIF TEQUIP:ニプルキャップ
	RETURNF 0
;搾乳器使用中は不可
SIF TEQUIP:搾乳器
	RETURNF 0
;乳房電極装着中はダメ
SIF TEQUIP:乳房電極
	RETURNF 0
;ヴァンパイアや獣人、獣には従順4がないと使用不可（プレイヤーがサドならＯＫ）
SELECTCASE CSTR:種族
	CASE "ヴァンパイア", "獣人", "獣"
		SIF ABL:従順 < 4 && !TALENT:PLAYER:サド
			RETURNF 0
ENDSELECT

COMRESULT = 1
RETURNF 1

@COM_シャワー
PRINTL シャワー
CALL KOJO_MESSAGE_COM

;着脱の処理
INVERTBIT TEQUIP:シャワー, 0

;-------------------------------------------------
;絶頂チェック
;-------------------------------------------------
CALL SOURCE_CHECK_CVAB

;-------------------------------------------------
;射精チェック
;-------------------------------------------------
CALL SAMEN_CHECK_T, 0

CALL SAMEN_SHOOT_T, 0, NOWEX:射精

RETURN 1

;-------------------------------------------------
;装着継続の処理
;-------------------------------------------------
@EQUIP_COM_シャワー
PRINTL ＜シャワー使用中＞

;-------------------------------------------------
;ソース追加処理
;-------------------------------------------------
;消費体力、気力
LOSEBASE:体力 += 5
LOSEBASE:気力 += 10

DOWNBASE:MASTER:体力 += 5
DOWNBASE:MASTER:気力 += 10

SOURCE:恭順 += 100
SOURCE:鬱屈 += 50
SOURCE:反感 += 50

;-------------------------------------------------
;特殊ソース処理
;-------------------------------------------------
SELECTCASE CSTR:種族
	;ヴァンパイア（流水の中では動けないため、いろいろ追加）
	CASE "ヴァンパイア"
		SOURCE:恐怖 += 200
		SOURCE:屈従 += 200
		SOURCE:不潔 += 500
		SOURCE:逸脱 += 500
		SOURCE:反感 += 500
	;獣人、獣の場合（まぁ基本洗われるのは嫌と解釈）
	CASE "獣人", "獣"
		SOURCE:恐怖 += 100
		SOURCE:屈従 += 100
		SOURCE:逸脱 += 500
		SOURCE:反感 += 500
	;人魚はLOSEBASEを軽減する
	CASE "人魚"
		LOSEBASE:体力 -= 10
		LOSEBASE:気力 -= 10
		SOURCE:鬱屈 -= 50
		SOURCE:反感 -= 50
ENDSELECT

;-------------------------------------------------
;汚れの処理
;-------------------------------------------------
;シャワーで汚れは常にリセット
RESET_STAIN TARGET

;潤滑を1000減らす
IF PALAM:潤滑 > 1000
	PALAM:潤滑 -= 1000
ELSE
	PALAM:潤滑 = 0
ENDIF

RETURN 1

